{namespace v=FluidTYPO3\Vhs\ViewHelpers}
{namespace flux=FluidTYPO3\Flux\ViewHelpers}
<div xmlns="http://www.w3.org/1999/xhtml" lang="en"
   xmlns:f="http://typo3.org/ns/fluid/ViewHelpers"
   xmlns:flux="http://fedext.net/ns/flux/ViewHelpers"
   xmlns:v="http://fedext.net/ns/vhs/ViewHelpers">
   <f:layout name="Content" />

   <f:section name="Configuration">
      <flux:form id="tsi_googlemap" label="Maps" description="Zeigt Google Maps Karte an" options="{icon: '/typo3conf/ext/tsi_site/Resources/Public/Backend/img/Map.png'}">
         <flux:field.input name="Lat" label="Lat"></flux:field.input>
         <flux:field.input name="Lng" label="Lng"></flux:field.input>
         <flux:field.input name="Zoom" label="Zoom"></flux:field.input>
      </flux:form>
   </f:section>
<f:section name="Preview">
      <f:render section="Main" arguments="{Lat:'0.0', Lng:'0.0'}" />
   </f:section>
   <f:section name="Main">
      <div class="container">
         <div id="googleMap" style="height:40vh;">
            <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQ1TK7MS9FXtuqigjAPRk2SC1EZGYRdto"></script>
            <script>
               <![CDATA[
                var myCenter = new google.maps.LatLng(]]>{Lat}<![CDATA[, ]]>{Lng}<![CDATA[);
               ]]>

                if (screen.width <= 768 && screen.height <= 1024) {
                    var value = false;
                } else {
                    var value = true;
                }

                function initialize() {
                        <![CDATA[
                                //Init google map zoom
                                var zoom = "]]>{Zoom}<![CDATA[";
                                var zoomInt = parseInt(zoom);
                        ]]>
                    var mapProp = {
                        center:myCenter,
                        draggable: value,
                        zoom:zoomInt,
                        mapTypeId:google.maps.MapTypeId.ROADMAP,
                        styles: [
                            {
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#f5f5f5"
                                    }
                                ]
                            },
                            {
                                "elementType": "labels.icon",
                                "stylers": [
                                    {
                                        "visibility": "off"
                                    }
                                ]
                            },
                            {
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#616161"
                                    }
                                ]
                            },
                            {
                                "elementType": "labels.text.stroke",
                                "stylers": [
                                    {
                                        "color": "#f5f5f5"
                                    }
                                ]
                            },
                            {
                                "featureType": "administrative.land_parcel",
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#bdbdbd"
                                    }
                                ]
                            },
                            {
                                "featureType": "poi",
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#eeeeee"
                                    }
                                ]
                            },
                            {
                                "featureType": "poi",
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#757575"
                                    }
                                ]
                            },
                            {
                                "featureType": "poi.park",
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#e5e5e5"
                                    }
                                ]
                            },
                            {
                                "featureType": "poi.park",
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#9e9e9e"
                                    }
                                ]
                            },
                            {
                                "featureType": "road",
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#ffffff"
                                    }
                                ]
                            },
                            {
                                "featureType": "road.arterial",
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#757575"
                                    }
                                ]
                            },
                            {
                                "featureType": "road.highway",
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#dadada"
                                    }
                                ]
                            },
                            {
                                "featureType": "road.highway",
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#616161"
                                    }
                                ]
                            },
                            {
                                "featureType": "road.local",
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#9e9e9e"
                                    }
                                ]
                            },
                            {
                                "featureType": "transit.line",
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#e5e5e5"
                                    }
                                ]
                            },
                            {
                                "featureType": "transit.station",
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#eeeeee"
                                    }
                                ]
                            },
                            {
                                "featureType": "water",
                                "elementType": "geometry",
                                "stylers": [
                                    {
                                        "color": "#c9c9c9"
                                    }
                                ]
                            },
                            {
                                "featureType": "water",
                                "elementType": "labels.text.fill",
                                "stylers": [
                                    {
                                        "color": "#9e9e9e"
                                    }
                                ]
                            }
                        ]
                    };

                    var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

                    var marker = new google.maps.Marker({
                        position:myCenter,
                        icon: "Img/Icons/gmap-marker.png"
                    });

                    marker.setMap(map);
                }
                google.maps.event.addDomListener(window, 'load', initialize);
            </script>
         </div>
   </f:section>
   </div>
</div>
